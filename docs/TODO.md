# KTW Bot å¾…è¾¦åŠŸèƒ½ (TODO)

> è¨˜éŒ„å¾…å¯¦ä½œçš„åŠŸèƒ½éœ€æ±‚

---

## ğŸ“‹ å¾…è¾¦é …ç›®

### ã€é«˜å„ªå…ˆã€‘æœ¬æœˆçµ±è¨ˆé¡¯ç¤ºã€Œä½¿ç”¨ä¸­æˆ¿é–“ã€

**éœ€æ±‚æè¿°**ï¼š
- ç›®å‰ã€Œæœ¬æœˆå…¥ä½ç‹€æ³ã€åªé¡¯ç¤ºã€Œç•¶æ—¥æ–°å…¥ä½ã€çš„ç­†æ•¸/é–“æ•¸
- ä½†å¦‚æœæœ‰å®¢äººçºŒä½ï¼ˆä½å¤šæ™šï¼‰ï¼Œç¬¬äºŒå¤©èµ·å°±ä¸æœƒè¢«è¨ˆå…¥
- æ‡‰è©²é¡¯ç¤ºã€Œ**ç•¶æ—¥ä½¿ç”¨ä¸­çš„æˆ¿é–“æ•¸**ã€ï¼ˆå…¥ä½ + çºŒä½ï¼‰

**è¨ˆç®—å…¬å¼**ï¼š
```
ä½¿ç”¨ä¸­æˆ¿é–“ = å…¥ä½æ—¥æœŸ â‰¤ ç•¶æ—¥ ä¸” é€€æˆ¿æ—¥æœŸ > ç•¶æ—¥
```

**ç¯„ä¾‹**ï¼š
- è¨‚å–® 00703801ï¼š12/27 å…¥ä½ï¼Œ12/29 é€€æˆ¿ï¼ˆä½ 2 æ™šï¼‰
- 12/27ï¼šæ–°å…¥ä½ 1 é–“ âœ…
- 12/28ï¼š**çºŒä½ 1 é–“**ï¼ˆç›®å‰é¡¯ç¤º 0ï¼Œæ‡‰é¡¯ç¤º 1ï¼‰
- 12/29ï¼šé€€æˆ¿

**å½±éŸ¿ç¯„åœ**ï¼š
- `LINEBOT/handlers/internal_query.py` - `query_month_forecast()`
- å¯èƒ½éœ€è¦ PMS API æ–°ç«¯é»æˆ–ä¿®æ”¹æŸ¥è©¢é‚è¼¯

**æå‡ºæ—¥æœŸ**ï¼š2025-12-21

---

### ã€ä¸­å„ªå…ˆã€‘Gemini SDK å‡ç´š

**éœ€æ±‚æè¿°**ï¼š
- ç›®å‰ä½¿ç”¨èˆŠç‰ˆ SDKï¼š`google-generativeai` v0.8.6
- å®˜æ–¹å·²å®£å¸ƒæ£„ç”¨ (deprecated)ï¼Œå»ºè­°åˆ‡æ›è‡³ `google.genai`

**å‡ç´šå½±éŸ¿**ï¼š
- éœ€é‡æ§‹ `bot.py`ã€`web_search.py`ã€`vip_service_handler.py` ä¸­çš„ import
- æ–° SDK ä½¿ç”¨ `Client()` æ¨¡å¼ï¼ŒAPI å‘¼å«æ–¹å¼ä¸åŒ
- å¯è§£é–æ–°åŠŸèƒ½ï¼š`thinking_level` åƒæ•¸æ§åˆ¶

**å½±éŸ¿ç¯„åœ**ï¼š
- `LINEBOT/bot.py` - ä¸»è¦ AI èª¿ç”¨
- `LINEBOT/handlers/web_search.py` - ç¶²è·¯æœå°‹
- `LINEBOT/handlers/vip_service_handler.py` - VIP æœå‹™

**åƒè€ƒæ–‡æª”**ï¼š
- https://ai.google.dev/gemini-api/docs/gemini-3

**æå‡ºæ—¥æœŸ**ï¼š2025-12-21

---

### ã€ä¸­å„ªå…ˆã€‘Bot æ¨¡çµ„åŒ–é‡æ§‹

**éœ€æ±‚æè¿°**ï¼š
- `bot.py` ç›®å‰ 1821 è¡Œï¼Œå¤ªè‚¥
- `same_day_booking.py` ç›®å‰ 1550 è¡Œï¼Œå¤ªè‚¥
- ç›®æ¨™ï¼šå–®ä¸€æª”æ¡ˆæ§åˆ¶åœ¨ 500-800 è¡Œ

**æ¶æ§‹æ‹†åˆ†**ï¼š
```
1. ä¸€èˆ¬é–’èŠ â†’ handlers/chat_handler.py (æ–°å»º)
2. è¨‚æˆ¿/æŸ¥è¨‚å–® â†’ helpers/booking_intent.py (çµ±ä¸€æ„åœ–åˆ¤æ–·)
3. æ—…ç®¡ç›¸é—œ â†’ vip_service_handler.py (ç¾æœ‰)
4. å¾ŒçºŒæ–°å¢ â†’ å¯æ“´å……æ¨¡çµ„
```

**åŸ·è¡Œæ­¥é©Ÿ**ï¼š
1. å»ºç«‹ `helpers/intent_router.py` - çµ±ä¸€æ„åœ–è·¯ç”±
2. å»ºç«‹ `helpers/booking_intent.py` - è¨‚æˆ¿/æŸ¥è¨‚å–®æ„åœ–åˆ¤æ–·
3. æŠ½é›¢ `handlers/chat_handler.py` - ä¸€èˆ¬é–’èŠ
4. ç²¾ç°¡ `bot.py` ä¸»è·¯ç”±
5. ç§»é™¤ `same_day_booking.py` é‡è¤‡çš„ `ROOM_TYPE_MAP`

**å½±éŸ¿ç¯„åœ**ï¼š
- `LINEBOT/bot.py`
- `LINEBOT/handlers/same_day_booking.py`
- `LINEBOT/helpers/intent_detector.py`

**æå‡ºæ—¥æœŸ**ï¼š2025-12-21

---

*æœ€å¾Œæ›´æ–°ï¼š2025-12-21*
